import{store as e,getContext as t,getElement as i,getConfig as n,withScope as r}from"@wordpress/interactivity";import{computePosition as o,autoUpdate as l,detectOverflow as s,offset as a,flip as E,shift as c,arrow as g,inline as d}from"//cdn.jsdelivr.net/npm/@floating-ui/dom@1.6.3/+esm";if(void 0===o)throw TypeError("WeCodeArt's tooltips require Floating UI (https://floating-ui.com/)");let{fn:{execute:p,executeAfterTransition:T,getElement:getDOMElement,findShadowRoot:u,validateConfig:m,isRTL:f,noop:h},Events:v,Template:w}=wecodeart,NAME="floating",NAMESPACE=`wecodeart/${NAME}`,DATA_KEY=`wp.${NAME}`,EVENT_KEY=`.${DATA_KEY}`,EVENT_SHOW=`show${EVENT_KEY}`,EVENT_SHOWN=`shown${EVENT_KEY}`,EVENT_INSERTED=`inserted${EVENT_KEY}`,EVENT_HIDE=`hide${EVENT_KEY}`,EVENT_HIDDEN=`hidden${EVENT_KEY}`,TRIGGER_HOVER="hover",TRIGGER_FOCUS="focus",TRIGGER_CLICK="click",TRIGGER_MANUAL="manual",SELECTOR_TOOLTIP_ARROW=".wp-floating__arrow",SELECTOR_TOOLTIP_HEAD=".wp-floating__head",SELECTOR_TOOLTIP_BODY=".wp-floating__body",AttachmentMap={AUTO:"auto",TOP:"top",RIGHT:f()?"left":"right",BOTTOM:"bottom",LEFT:f()?"right":"left"},{state:A,actions:O,callbacks:R}=e(NAMESPACE,{state:{get getContent(){let{content:N=A.content}=t();return R.resolvePossibleFunction(N)},get getTitle(){let{title:b=A.title}=t();return R.resolvePossibleFunction(b)},get getDelay(){let{delay:C=A.delay}=t();switch((C="string"==typeof C?C.split(",").map(e=>Number.parseInt(e,10)):[C]).length){case 1:C={show:C[0],hide:C[0]};break;case 2:C={show:C[0],hide:C[1]}}return C},get getOffset(){let{offset:I=A.offset}=t();switch("string"==typeof I&&(I=I.split(",").map(e=>Number.parseInt(e,10))),I.length){case 1:I={mainAxis:I[0]};break;case 2:I={mainAxis:I[0],crossAxis:I[1]};break;case 3:I={mainAxis:I[0],crossAxis:I[1],alignmentAxis:I[2]}}return I},get isWithContent(){return Boolean(A.getTitle||A.getContent)},get isWithActiveTrigger(){let{activeTrigger:y={}}=t();return Object.values(y).includes(!0)},get isAnimated(){let{animation:P}=A,{tip:D}=t();return P||D&&D.classList.contains("fade")},get isShown(){let{tip:S}=t();return S&&S.classList.contains("show")}},actions:{enable(){let e=t();e.isEnabled=!0},disable(){let e=t();e.isEnabled=!1},toggleEnabled(){let e=t();e.isEnabled=!e.isEnabled},toggle(e){let i=t(),{isEnabled:n}=A;if(n){if(i.activeTrigger={},i.activeTrigger.click=!!i.activeTrigger.click,A.isShown){O.leave(e);return}O.enter(e)}},show(e){if(A.isShown)return;let{ref:n}=i();if("none"===n.style.display)throw Error("Please use show on visible elements");let{isEnabled:o}=A;if(!(A.isWithContent&&o))return;let s=v.trigger(n,EVENT_SHOW),a=u(n),E=(a||n.ownerDocument.documentElement).contains(n);if(s.defaultPrevented||!E)return;R.disposePopper();let c=R.getTipElement(),g=t();if(n.setAttribute("aria-describedby",c.getAttribute("id")),!n.ownerDocument.documentElement.contains(c)){let d=g.container?getDOMElement(g.container):document.body;d.append(c),g.cleanup=l(n,c,r(R.createPopper)),v.trigger(n,EVENT_INSERTED)}if(c.classList.add("show"),"ontouchstart"in document.documentElement)for(let p of[].concat(...document.body.children))v.on(p,"mouseover",h);let m=r(()=>{v.trigger(n,EVENT_SHOWN),!1===g.isHovered&&O.leave(e),g.isHovered=!1});T(m,c,A.isAnimated)},hide(){let{ref:e}=i(),n=v.trigger(e,EVENT_HIDE);if(n.defaultPrevented)return;let o=R.getTipElement();if(o.classList.remove("show"),"ontouchstart"in document.documentElement)for(let l of[].concat(...document.body.children))v.off(l,"mouseover",h);let s=t();s.activeTrigger.click=!1,s.activeTrigger[TRIGGER_FOCUS]=!1,s.activeTrigger[TRIGGER_HOVER]=!1,s.isHovered=null;let a=r(()=>{!A.isWithActiveTrigger&&(s.isHovered||R.disposePopper(),e.removeAttribute("aria-describedby"),v.trigger(e,EVENT_HIDDEN))});T(a,o,A.isAnimated)},enter(e){let{type:i}=e,n=t();if(n.activeTrigger={},n.activeTrigger["focusin"===i?TRIGGER_FOCUS:TRIGGER_HOVER]=!0,A.isShown||n.isHovered){n.isHovered=!0;return}n.isHovered=!0;let{show:r}=A.getDelay;R.withTimeout(()=>O.show(e),r)},leave(e){let{type:i,target:n,relatedTarget:r}=e,o=t();if(o.activeTrigger["focusout"===i?TRIGGER_FOCUS:TRIGGER_HOVER]=n&&n.contains(r),A.isWithActiveTrigger)return;o.isHovered=!1;let{hide:l}=A.getDelay;R.withTimeout(()=>O.hide(e),l)},setContent(e){let i=t();i.newContent=e,A.isShown&&(R.disposePopper(),O.show())}},callbacks:{getTemplateFactory(e){let i=t();if(i.templateFactory)i.templateFactory.changeContent(e);else{let n={...A,...i};i.templateFactory=new w({...n,content:e,extraClass:R.resolvePossibleFunction(n.className)})}return i.templateFactory},getTipElement(){let e=t();return e.tip||(e.tip=R.createTipElement(e.newContent||R.getContentForTemplate())),e.tip},getContentForTemplate(){let{plugin:e}=t(),i={};return i="popover"===e?{".wp-floating__head":A.getTitle,[SELECTOR_TOOLTIP_BODY]:A.getContent}:{[SELECTOR_TOOLTIP_BODY]:A.getTitle}},createTipElement(e){let i=R.getTemplateFactory(e).toHtml();i.classList.remove("fade","show"),i.classList.add(`wp-${NAME}--auto`);let{plugin:n="tooltip"}=t();i.classList.add(`wp-${NAME}--${n}`);let r=R.getUID().toString();return i.setAttribute("id",r),A.isAnimated&&i.classList.add("fade"),i},createPopper(){let{ref:e}=i(),n=R.getTipElement(),{placement:r,fallbackPlacements:l,shift:s,offset:p}={...A,...t()},T=AttachmentMap[R.resolvePossibleFunction(r).toUpperCase()],u=n.querySelector(".wp-floating__arrow");return o(e,n,{placement:T,middleware:[a({...p}),E({fallbackPlacements:l}),!!s&&c({...s}),!!u&&g({element:u}),d(),{name:"setPlacement",fn:({placement:e})=>(n.setAttribute("data-placement",e),{})},].filter(Boolean)}).then(({x:e,y:t,middlewareData:{arrow:i}={}})=>{if(i){let{x:r,y:o}=i;Object.assign(u.style,{left:null!=r?`${r}px`:"",top:null!=o?`${o}px`:""})}Object.assign(n.style,{position:"absolute",inset:"auto",margin:"0",top:"0",left:"0",transform:`translate3d(${R.roundByDPR(e)}px,${R.roundByDPR(t)}px,0)`})})},disposePopper(){let e=t();e.tip&&(e.tip.remove(),e.tip=null),e.cleanup&&(e.cleanup(),e.cleanup=null)},validateConfig:()=>m(NAME,{...A,...t()},n(NAMESPACE)),getUID(){let e=`wp-${NAME}-`;do e+=Math.floor(1e6*Math.random());while(document.getElementById(e));return e},resolvePossibleFunction(e){let{ref:t}=i();return p(e,[t])},roundByDPR(e){let t=window.devicePixelRatio||1;return Math.round(e*t)/t},withTimeout(e,i){let n=t();clearTimeout(n.timeout),n.timeout=setTimeout(r(e),i)}}});